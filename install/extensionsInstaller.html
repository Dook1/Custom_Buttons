<!DOCTYPE HTML>
<meta charset="utf-8"/>
<title>Extensions Installer [0.3.0 - 2015-09-08]</title>
<body>
<a href="custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3EExtensions%20Installer%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABU1BMVEUAAADOmwAcTL9Ok+hYmek4f+BOkOVgmebityHdqgDZpgBShdpVh9tYlub17rH04ITQnwTz0lParhzOmwBHd9MeWcnyzTD93lfx3HzHlAAcUcN/ckezgAAcTL+uewCqegOqdwCqdwAcTL8dWMnt2nYdVcYdXMyziA8cUcNRgthKf9jt6bJgmeZknOdZmeponuc8ctMmYs5bleXAlhBajd9Lg9w/g+FZmOjt8tw3a89em+lclONrc2vTrSTguyfctiPkwS5VkuU4dthmm+VEh+JckeGNez1TjODNow/Spw/awVhSjeJNiuHMog/arw+sgQ9cj99HhuAcTsHZwFhTlOdQj+RYj+FXleaLlHZKi+NYidtkmeU2cdQiY9AeYM9yfm/awmHUsi9XkePezXfezHdgl+Tk3qnbsA+nfA8qbdXKoBBBgt88f943e92idw5hleJflOL5TOKYAAAAInRSTlMA63+doYfKleuw65/LzPXr8OvrsJy/9evw63+66z928LDrU3XUpQAAALRJREFUeF51yMOSxFAYQOE/bdvjG7Vt2zaGNt6fcydZdGXR3+ZUHThEEhQLRzY1Fw7tSrYf8lDAH60sNvWklB+13VPuvteffHx+8ePnt7Fsre+6D48zhRKwcTxRfXtPY88qAPVW4728ur659fl0egMAeDzhCMMwMYqijCaCMIMlYyVJMl8olso2u8MJ/2iabrJYu8MCx4254GgwHLn5McUAjl9ecTgihNDJ6dk3QiLYO7/g+weiox46am7rEgAAAABJRU5ErkJggg%3D%3D%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5B/*Initialization%20Code*/%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5B//%20https%3A//github.com/Infocatcher/Custom_Buttons/tree/master/Extensions_Installer%0A%0A//%20Extensions%20Installer%20button%20for%20Custom%20Buttons%0A//%20%28code%20for%20%22code%22%20section%29%0A//%20For%20developers%2C%20useful%20to%20test%20restartless%20extensions.%0A//%20Place%20code%20to%20%22initialization%22%20section%20to%20create%20a%20%22normal%22%20menu.%0A%0A//%20%28c%29%20Infocatcher%202013-2015%0A//%20version%200.3.0%20-%202015-09-08%0A%0Avar%20rootDir%20%3D%20%22d%3A%5C%5Cextensions%5C%5C%22%3B%0Aif%28%21file%28rootDir%29.exists%28%29%29%0A%09rootDir%20%3D%20%22z%3A%5C%5Cdev%5C%5Cextensions%5C%5C%22%3B%0Avar%20extensions%20%3D%20%7B%0A%09%22extensionsId1@example%22%3A%20%7B%0A%09%09name%3A%20%22Extension%201%22%2C%0A%09%09dir%3A%20rootDir%20+%20%22my_extension%22%2C%0A%09%09xpi%3A%20%22%25d%5C%5Cmy_extension-latest.xpi%22%0A%09%7D%2C%0A%09%22extensionsId2@example%22%3A%20%7B%0A%09%09name%3A%20%22Extension%202%22%2C%0A%09%09dir%3A%20rootDir%20+%20%22my_extension_2%22%2C%0A%09%09xpi%3A%20%22%25d%5C%5Cmy_extension2-latest.xpi%22%2C%0A%09%09makeExe%3A%20%22d%3A%5C%5CsomeMaker.exe%22%2C%0A%09%09makeArgs%3A%20%5B%22some%22%2C%20%22args%22%2C%20%22here%22%5D%0A%09%7D%0A%7D%3B%0Avar%20_makeExe%20%3D%20%22%25COMMANDER_PATH%25%5C%5Cutils%5C%5CDelayed_Start%5C%5Cds.exe%22%3B%0Avar%20_makeArgs%20%3D%20%5B%0A%09%22-w%22%2C%0A%09%22-k999%22%2C%0A%09%22%25d%5C%5Cmake.bat%22%2C%0A%09%22nodelay%22%0A%5D%3B%0A%0Afunction%20_localize%28s%2C%20key%29%20%7B%0A%09var%20strings%20%3D%20%7B%0A%09%09%22Version%3A%20%25S%22%3A%20%7B%0A%09%09%09ru%3A%20%22%u0412%u0435%u0440%u0441%u0438%u044F%3A%20%25S%22%0A%09%09%7D%2C%0A%09%09%22Updated%3A%20%25S%22%3A%20%7B%0A%09%09%09ru%3A%20%22%u041E%u0431%u043D%u043E%u0432%u043B%u0435%u043D%u043E%3A%20%25S%22%0A%09%09%7D%2C%0A%09%09%22Ok%21%22%3A%20%7B%0A%09%09%09ru%3A%20%22%u041E%u041A%21%22%0A%09%09%7D%2C%0A%09%09%22Successfully%20installed%3A%5Cn%25N%20%25V%22%3A%20%7B%0A%09%09%09ru%3A%20%22%u0423%u0441%u043F%u0435%u0448%u043D%u043E%20%u0443%u0441%u0442%u0430%u043D%u043E%u0432%u043B%u0435%u043D%u043E%3A%5Cn%25N%20%25V%22%0A%09%09%7D%0A%09%7D%3B%0A%09var%20locale%20%3D%20%28function%28%29%20%7B%0A%09%09var%20prefs%20%3D%20%22Services%22%20in%20window%20%26%26%20Services.prefs%0A%09%09%09%7C%7C%20Components.classes%5B%22@mozilla.org/preferences-service%3B1%22%5D%0A%09%09%09%09.getService%28Components.interfaces.nsIPrefBranch%29%3B%0A%09%09if%28%21prefs.getBoolPref%28%22intl.locale.matchOS%22%29%29%20%7B%0A%09%09%09var%20locale%20%3D%20prefs.getCharPref%28%22general.useragent.locale%22%29%3B%0A%09%09%09if%28locale.substr%280%2C%209%29%20%21%3D%20%22chrome%3A//%22%29%0A%09%09%09%09return%20locale%3B%0A%09%09%7D%0A%09%09return%20Components.classes%5B%22@mozilla.org/chrome/chrome-registry%3B1%22%5D%0A%09%09%09.getService%28Components.interfaces.nsIXULChromeRegistry%29%0A%09%09%09.getSelectedLocale%28%22global%22%29%3B%0A%09%7D%29%28%29.match%28/%5E%5Ba-z%5D*/%29%5B0%5D%3B%0A%09_localize%20%3D%20%21locale%20%7C%7C%20locale%20%3D%3D%20%22en%22%0A%09%09%3F%20function%28s%29%20%7B%0A%09%09%09return%20s%3B%0A%09%09%7D%0A%09%09%3A%20function%28s%2C%20key%29%20%7B%0A%09%09%09if%28%21key%29%0A%09%09%09%09key%20%3D%20s%3B%0A%09%09%09return%20strings%5Bkey%5D%20%26%26%20strings%5Bkey%5D%5Blocale%5D%20%7C%7C%20s%3B%0A%09%09%7D%3B%0A%09return%20_localize.apply%28this%2C%20arguments%29%3B%0A%7D%0A%0Aif%28%21%28%22AddonManager%22%20in%20window%29%29%0A%09Components.utils.import%28%22resource%3A//gre/modules/AddonManager.jsm%22%29%3B%0A%0Avar%20mp%20%3D%20document.createElement%28%22menupopup%22%29%3B%0Amp.setAttribute%28%22oncommand%22%2C%20%22this.installExtension%28event%29%3B%22%29%3B%0Amp.setAttribute%28%22onpopupshowing%22%2C%20%22this.createMenu%28%29%3B%22%29%3B%0Amp.setAttribute%28%22onmousedown%22%2C%20%22event.target.setAttribute%28%27closemenu%27%2C%20event.shiftKey%20%3F%20%27none%27%20%3A%20%27auto%27%29%3B%22%29%3B%0Amp.setAttribute%28%22onclick%22%2C%20%22this.handleClick%28event%29%3B%22%29%3B%0A%0Avar%20tb%20%3D%20this.parentNode%3B%0Aif%28tb.getAttribute%28%22orient%22%29%20%3D%3D%20%22vertical%22%29%20%7B%0A%09//%20https%3A//addons.mozilla.org/firefox/addon/vertical-toolbar/%0A%09var%20isRight%20%3D%20tb.parentNode.getAttribute%28%22placement%22%29%20%3D%3D%20%22right%22%3B%0A%09mp.setAttribute%28%22position%22%2C%20isRight%20%3F%20%22start_before%22%20%3A%20%22end_before%22%29%3B%0A%7D%0A%0Amp.createMenu%20%3D%20function%28%29%20%7B%0A%09mp.setAttribute%28%22onpopupshowing%22%2C%20%22this.updateMenu%28%29%3B%22%29%3B%0A%0A%09for%28var%20uid%20in%20extensions%29%20if%28extensions.hasOwnProperty%28uid%29%29%20%7B%0A%09%09var%20ext%20%3D%20extensions%5Buid%5D%3B%0A%09%09var%20mi%20%3D%20document.createElement%28%22menuitem%22%29%3B%0A%09%09mi.className%20%3D%20%22menuitem-iconic%22%3B%0A%09%09mi.setAttribute%28%22cb_uid%22%2C%20uid%29%3B%0A%09%09mi.setAttribute%28%22label%22%2C%20ext.name%29%3B%0A%09%09mi.setAttribute%28%22tooltiptext%22%2C%20ext.dir%29%3B%0A%09%09setStyle%28mi%2C%20uid%29%3B%0A%09%09mp.appendChild%28mi%29%3B%0A%09%7D%0A%7D%3B%0Amp.updateMenu%20%3D%20function%28%29%20%7B%0A%09Array.forEach%28%0A%09%09mp.getElementsByTagName%28%22menuitem%22%29%2C%0A%09%09function%28mi%29%20%7B%0A%09%09%09setStyle%28mi%2C%20mi.getAttribute%28%22cb_uid%22%29%29%3B%0A%09%09%7D%0A%09%29%3B%0A%7D%3B%0Amp.handleClick%20%3D%20function%28e%29%20%7B%0A%09if%28e.button%20%3D%3D%200%20%7C%7C%20e.ctrlKey%20%7C%7C%20e.altKey%20%7C%7C%20e.shiftKey%20%7C%7C%20e.metaKey%29%0A%09%09return%3B%0A%09if%28e.button%20%3D%3D%201%29%0A%09%09this.toggleExtension%28e.target%29%3B%0A%09else%20if%28e.button%20%3D%3D%202%29%20%7B%0A%09%09e.preventDefault%28%29%3B%0A%09%09this.openExtensionOptions%28e.target%29%3B%0A%09%7D%0A%7D%3B%0Amp.toggleExtension%20%3D%20function%28mi%29%20%7B%0A%09var%20uid%20%3D%20mi.getAttribute%28%22cb_uid%22%29%3B%0A%09if%28%21uid%29%0A%09%09return%3B%0A%09AddonManager.getAddonByID%28uid%2C%20function%28addon%29%20%7B%0A%09%09if%28addon%29%20%7B%0A%09%09%09addon.userDisabled%20%3D%20%21addon.userDisabled%3B%0A%09%09%09setStyle%28mi%2C%20uid%2C%20addon%29%3B%0A%09%09%7D%0A%09%7D%29%3B%0A%7D%3B%0Amp.openExtensionOptions%20%3D%20function%28mi%29%20%7B%0A%09var%20uid%20%3D%20mi.getAttribute%28%22cb_uid%22%29%3B%0A%09if%28%21uid%29%0A%09%09return%3B%0A%09AddonManager.getAddonByID%28uid%2C%20function%28addon%29%20%7B%0A%09%09if%28addon%20%26%26%20openAddonOptions%28addon%29%29%0A%09%09%09mi.parentNode.hidePopup%28%29%3B%0A%09%7D%29%3B%0A%7D%3B%0Afunction%20openAddonOptions%28addon%29%20%7B%0A%09//%20Based%20on%20code%20from%20chrome%3A//mozapps/content/extensions/extensions.js%0A%09//%20Firefox%2021.0a1%20%282013-01-27%29%0A%09if%28%21%28%22Services%22%20in%20window%29%29%0A%09%09Components.utils.import%28%22resource%3A//gre/modules/Services.jsm%22%29%3B%0A%09var%20optionsURL%20%3D%20addon.optionsURL%3B%0A%09if%28%21addon.isActive%20%7C%7C%20%21optionsURL%29%0A%09%09return%20false%3B%0A%09if%28addon.type%20%3D%3D%20%22plugin%22%29%20//%20No%20options%20for%20now%21%0A%09%09return%20false%3B%0A%09if%28addon.optionsType%20%3D%3D%20AddonManager.OPTIONS_TYPE_INLINE%29%0A%09%09openAddonPage%28addon%2C%20true%29%3B%0A%09else%20if%28addon.optionsType%20%3D%3D%20AddonManager.OPTIONS_TYPE_TAB%20%26%26%20%22switchToTabHavingURI%22%20in%20window%29%0A%09%09switchToTabHavingURI%28optionsURL%2C%20true%29%3B%0A%09else%20%7B%0A%09%09let%20windows%20%3D%20Services.wm.getEnumerator%28null%29%3B%0A%09%09while%28windows.hasMoreElements%28%29%29%20%7B%0A%09%09%09let%20win%20%3D%20windows.getNext%28%29%3B%0A%09%09%09if%28win.document.documentURI%20%3D%3D%20optionsURL%29%20%7B%0A%09%09%09%09win.focus%28%29%3B%0A%09%09%09%09return%20true%3B%0A%09%09%09%7D%0A%09%09%7D%0A%09%09//%20Note%3A%20original%20code%20checks%20browser.preferences.instantApply%20and%20may%20open%20modal%20windows%0A%09%09window.openDialog%28optionsURL%2C%20%22%22%2C%20%22chrome%2Ctitlebar%2Ctoolbar%2Ccenterscreen%2Cdialog%3Dno%22%29%3B%0A%09%7D%0A%09return%20true%3B%0A%7D%0Afunction%20openAddonsManager%28view%29%20%7B%0A%09var%20openAddonsMgr%20%3D%20window.BrowserOpenAddonsMgr%20//%20Firefox%0A%09%09%7C%7C%20window.openAddonsMgr%20//%20Thunderbird%0A%09%09%7C%7C%20window.toEM%3B%20//%20SeaMonkey%0A%09openAddonsMgr%28view%29%3B%0A%7D%0Afunction%20openAddonPage%28addon%2C%20scrollToPreferences%29%20%7B%0A%09scrollToPreferences%20%3D%20scrollToPreferences%20%26%26%20parseFloat%28Services.appinfo.platformVersion%29%20%3E%3D%2012%0A%09%09%3F%20%22/preferences%22%0A%09%09%3A%20%22%22%3B%0A%09openAddonsManager%28%22addons%3A//detail/%22%20+%20encodeURIComponent%28addon.id%29%20+%20scrollToPreferences%29%3B%0A%7D%0Afunction%20setStyle%28mi%2C%20uid%2C%20addon%29%20%7B%0A%09function%20getAddonCallback%28addon%29%20%7B%0A%09%09var%20icon%20%3D%20%22%22%3B%0A%09%09var%20color%20%3D%20%22grayText%22%3B%0A%09%09var%20iconOpacity%20%3D%20%220.5%22%3B%0A%09%09if%28addon%29%20%7B%0A%09%09%09icon%20%3D%20addon.iconURL%0A%09%09%09%09%7C%7C%20addon.icon64URL%0A%09%09%09%09%7C%7C%20%22chrome%3A//mozapps/skin/extensions/extensionGeneric-16.png%22%3B%0A%09%09%09if%28addon.isActive%29%0A%09%09%09%09color%20%3D%20iconOpacity%20%3D%20%22%22%3B%0A%09%09%09else%20if%28addon.appDisabled%29%0A%09%09%09%09color%20%3D%20%22red%22%3B%0A%09%09%09var%20tt%20%3D%20%28mi.tooltipText%20%7C%7C%20%22%22%29.replace%28/%20%5Cn%5B%5Cs%5CS%5D*%24/%2C%20%22%22%29%3B%0A%09%09%09mi.tooltipText%20%3D%20tt%0A%09%09%09%09+%20%22%20%5Cn%22%20+%20_localize%28%22Version%3A%20%25S%22%29.replace%28%22%25S%22%2C%20addon.version%29%0A%09%09%09%09+%20%22%20%5Cn%22%20+%20_localize%28%22Updated%3A%20%25S%22%29.replace%28%22%25S%22%2C%20addon.updateDate%20%3F%20new%20Date%28addon.updateDate%29.toLocaleString%28%29%20%3A%20%22%3F%3F%3F%22%29%3B%0A%09%09%7D%0A%09%09mi.setAttribute%28%22image%22%2C%20icon%29%3B%0A%09%09mi.style.color%20%3D%20color%3B%0A%09%09var%20icon%20%3D%20mi.ownerDocument.getAnonymousElementByAttribute%28mi%2C%20%22class%22%2C%20%22menu-iconic-icon%22%29%3B%0A%09%09if%28icon%29%0A%09%09%09icon.style.opacity%20%3D%20iconOpacity%3B%0A%09%7D%0A%09if%28addon%20%21%3D%3D%20undefined%29%0A%09%09getAddonCallback%28addon%29%3B%0A%09else%0A%09%09AddonManager.getAddonByID%28uid%2C%20getAddonCallback%29%3B%0A%09setTimeout%28function%28%29%20%7B%0A%09%09var%20dir%20%3D%20file%28expandVariables%28extensions%5Buid%5D.dir%29%29%3B%0A%09%09mi.style.textDecoration%20%3D%20dir.exists%28%29%20%3F%20%22%22%20%3A%20%22line-through%22%3B%0A%09%7D%2C%200%29%3B%0A%7D%0A%0Amp.installExtension%20%3D%20function%28e%29%20%7B%0A%09var%20mi%20%3D%20e.target%3B%0A%09var%20uid%20%3D%20mi.getAttribute%28%22cb_uid%22%29%3B%0A%09if%28%21uid%20%7C%7C%20%21extensions.hasOwnProperty%28uid%29%29%0A%09%09return%3B%0A%09var%20ext%20%3D%20extensions%5Buid%5D%3B%0A%0A%09var%20make%20%3D%20%21event.ctrlKey%20%26%26%20%21event.altKey%20%26%26%20%21event.metaKey%3B%0A%0A%09var%20dir%20%3D%20expandVariables%28ext.dir%29%3B%0A%09function%20expandDir%28s%29%20%7B%0A%09%09return%20s.replace%28/%5E%25d/%2C%20dir%29%3B%0A%09%7D%0A%09var%20xpi%20%3D%20expandDir%28ext.xpi%29%3B%0A%09var%20makeExe%20%3D%20ext.makeExe%20%7C%7C%20_makeExe%3B%0A%09var%20makeArgs%20%3D%20ext.makeArgs%20%7C%7C%20_makeArgs%3B%0A%0A%09var%20lockKey%20%3D%20%22__extensionsInstaller_%22%20+%20xpi%3B%0A%09if%28lockKey%20in%20window%29%0A%09%09return%3B%0A%09window%5BlockKey%5D%20%3D%20true%3B%0A%09mi.disabled%20%3D%20true%3B%0A%09function%20unlock%28%29%20%7B%0A%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09mi.disabled%20%3D%20false%3B%0A%09%09%09delete%20window%5BlockKey%5D%3B%0A%09%09%7D%2C%20300%29%3B%0A%09%7D%0A%0A%09if%28%21%28%22Services%22%20in%20window%29%29%0A%09%09Components.utils.import%28%22resource%3A//gre/modules/Services.jsm%22%29%3B%0A%09if%28isCb%29%20%7B%0A%09%09var%20progressIcon%20%3D%20new%20ProgressIcon%28btn%29%3B%0A%09%09var%20restore%20%3D%20function%28%29%20%7B%0A%09%09%09unlock%28%29%3B%0A%09%09%09progressIcon.restore%28%29%3B%0A%09%09%7D%3B%0A%09%7D%0A%09else%20%7B%0A%09%09var%20restore%20%3D%20unlock%3B%0A%09%09notify%28%22Started%u2026%22%2C%20%22Started%20installation%u2026%22%29%3B%0A%09%7D%0A%0A%09var%20xpiFile%20%3D%20file%28xpi%29%3B%0A%0A%09if%28make%29%20try%20%7B%0A%09%09var%20process%20%3D%20Components.classes%5B%22@mozilla.org/process/util%3B1%22%5D%0A%09%09%09.createInstance%28Components.interfaces.nsIProcess%29%3B%0A%09%09process.init%28file%28expandVariables%28expandDir%28makeExe%29%29%29%29%3B%0A%09%09//var%20t%20%3D%20Date.now%28%29%3B%0A%09%09process.runw%28true%2C%20makeArgs.map%28expandDir%29.map%28expandVariables%29%2C%20makeArgs.length%29%3B%0A%09%09//LOG%28%22%5BExtensions%20Installer%5D%20process.runw%28%29%20done%20in%20%22%20+%20%28Date.now%28%29%20-%20t%29%20+%20%22ms%22%29%3B%0A%09%09setTimeout%28window.focus%2C%200%29%3B%20//%20Strange%20things%20happens...%0A%09%7D%0A%09catch%28e%29%20%7B%0A%09%09restore%28%29%3B%0A%09%09error%28%22Error%22%2C%20%22Can%27t%20make%20*.xpi%21%5Cn%22%20+%20e%29%3B%0A%09%09Components.utils.reportError%28%0A%09%09%09%22%5BExtensions%20Installer%5D%20Can%27t%20make%20*.xpi%21%5CnCommand%20line%3A%5Cn%22%0A%09%09%09+%20expandVariables%28makeExe%29%20+%20%22%5Cn%22%20+%20makeArgs.map%28expandVariables%29.join%28%22%5Cn%22%29%0A%09%09%29%3B%0A%09%09Components.utils.reportError%28e%29%3B%0A%09%09return%3B%0A%09%7D%0A%0A%09if%28%21xpiFile.exists%28%29%29%20%7B%0A%09%09restore%28%29%3B%0A%09%09error%28%22Error%22%2C%20%22File%20not%20found%3A%5Cn%22%20+%20xpi%29%3B%0A%09%09return%3B%0A%09%7D%0A%0A%09AddonManager.getInstallForFile%28%0A%09%09xpiFile%2C%0A%09%09function%28install%29%20%7B%0A%09%09%09if%28progressIcon%29%0A%09%09%09%09progressIcon.loading%28%29%3B%0A%09%09%09install.addListener%28%7B%0A%09%09%09%09onInstallEnded%3A%20function%28install%2C%20addon%29%20%7B%0A%09%09%09%09%09install.removeListener%28this%29%3B%0A%09%09%09%09%09restore%28%29%3B%0A%09%09%09%09%09var%20icon%20%3D%20addon.iconURL%20%7C%7C%20addon.icon64URL%3B%0A%09%09%09%09%09notify%28%0A%09%09%09%09%09%09_localize%28%22Ok%21%22%29%2C%0A%09%09%09%09%09%09_localize%28%22Successfully%20installed%3A%5Cn%25N%20%25V%22%29%0A%09%09%09%09%09%09%09.replace%28%22%25N%22%2C%20addon.name%29%0A%09%09%09%09%09%09%09.replace%28%22%25V%22%2C%20addon.version%29%2C%0A%09%09%09%09%09%09icon%0A%09%09%09%09%09%29%3B%0A%09%09%09%09%09if%28addon.pendingOperations%29%0A%09%09%09%09%09%09appRestart%28%29%3B%0A%09%09%09%09%7D%2C%0A%09%09%09%09onInstallFailed%3A%20function%28install%29%20%7B%0A%09%09%09%09%09install.removeListener%28this%29%3B%0A%09%09%09%09%09var%20err%20%3D%20%22Installation%20failed%5Cn%22%20+%20xpi%3B%0A%09%09%09%09%09Components.utils.reportError%28err%29%3B%0A%09%09%09%09%09restore%28%29%3B%0A%09%09%09%09%09error%28%22Error%22%2C%20err%29%3B%0A%09%09%09%09%7D%2C%0A%09%09%09%09onDownloadFailed%3A%20function%28install%29%20%7B%0A%09%09%09%09%09install.removeListener%28this%29%3B%0A%09%09%09%09%09var%20err%20%3D%20%22Downloading%20failed%5Cn%22%20+%20xpi%3B%0A%09%09%09%09%09Components.utils.reportError%28err%29%3B%0A%09%09%09%09%09restore%28%29%3B%0A%09%09%09%09%09error%28%22Error%22%2C%20err%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%29%3B%0A%09%09%09install.install%28%29%3B%0A%09%09%7D%2C%0A%09%09%22application/x-xpinstall%22%0A%09%29%3B%0A%7D%3B%0A//%20Based%20on%20code%20from%20resource%3A///components/fuelApplication.js%20in%20Firefox%2038%0Afunction%20appRestart%28%29%20%7B%0A%09return%20_quitWithFlags%28%0A%09%09Components.interfaces.nsIAppStartup.eAttemptQuit%0A%09%09%7C%20Components.interfaces.nsIAppStartup.eRestart%0A%09%29%3B%0A%7D%0Afunction%20_quitWithFlags%28flags%29%20%7B%0A%09if%28%21%28%22Services%22%20in%20window%29%29%0A%09%09Components.utils.import%28%22resource%3A//gre/modules/Services.jsm%22%29%3B%0A%09var%20cancelQuit%20%3D%20Components.classes%5B%22@mozilla.org/supports-PRBool%3B1%22%5D%0A%09%09.createInstance%28Components.interfaces.nsISupportsPRBool%29%3B%0A%09var%20quitType%20%3D%20flags%20%26%20Components.interfaces.nsIAppStartup.eRestart%20%3F%20%22restart%22%20%3A%20null%3B%0A%09Services.obs.notifyObservers%28cancelQuit%2C%20%22quit-application-requested%22%2C%20quitType%29%3B%0A%09if%28cancelQuit.data%29%0A%09%09return%20false%3B%20//%20somebody%20canceled%20our%20quit%20request%0A%09var%20appStartup%20%3D%20Components.classes%5B%22@mozilla.org/toolkit/app-startup%3B1%22%5D%0A%09%09.getService%28Components.interfaces.nsIAppStartup%29%3B%0A%09appStartup.quit%28flags%29%3B%0A%09return%20true%3B%0A%7D%0A%0Avar%20isCb%20%3D%20this%20instanceof%20XULElement%3B%20//%20Custom%20Buttons%0Avar%20isCbInit%20%3D%20isCb%0A%09%26%26%20typeof%20event%20%3D%3D%20%22object%22%0A%09%26%26%20%21%28%22type%22%20in%20event%29%0A%09%26%26%20typeof%20_phase%20%3D%3D%20%22string%22%20%26%26%20_phase%20%3D%3D%20%22init%22%3B%0Avar%20btn%20%3D%20isCb%20%26%26%20this%3B%0Aif%28isCbInit%29%20%7B%0A%09this.type%20%3D%20%22menu%22%3B%0A%09this.orient%20%3D%20%22horizontal%22%3B%0A%09this.appendChild%28mp%29%3B%0A%0A%09this.onmouseover%20%3D%20function%28e%29%20%7B%0A%09%09if%28e.target%20%21%3D%20this%29%0A%09%09%09return%3B%0A%09%09Array.some%28%0A%09%09%09this.parentNode.getElementsByTagName%28%22*%22%29%2C%0A%09%09%09function%28node%29%20%7B%0A%09%09%09%09if%28%0A%09%09%09%09%09node%20%21%3D%20this%0A%09%09%09%09%09%26%26%20node.namespaceURI%20%3D%3D%20xulns%0A%09%09%09%09%09%26%26%20node.boxObject%0A%09%09%09%09%09//%20See%20https%3A//github.com/Infocatcher/Custom_Buttons/issues/28%0A%09%09%09%09%09//%26%26%20node.boxObject%20instanceof%20Components.interfaces.nsIMenuBoxObject%0A%09%09%09%09%09%26%26%20%22open%22%20in%20node%0A%09%09%09%09%09%26%26%20node.open%0A%09%09%09%09%09%26%26%20node.getElementsByTagName%28%22menupopup%22%29.length%0A%09%09%09%09%29%20%7B%0A%09%09%09%09%09node.open%20%3D%20false%3B%0A%09%09%09%09%09this.open%20%3D%20true%3B%0A%09%09%09%09%09return%20true%3B%0A%09%09%09%09%7D%0A%09%09%09%09return%20false%3B%0A%09%09%09%7D%2C%0A%09%09%09this%0A%09%09%29%3B%0A%09%7D%3B%0A%7D%0Aelse%20%7B%20//%20Mouse%20gestures%20or%20something%20other...%0A%09let%20e%3B%0A%09if%28typeof%20event%20%3D%3D%20%22object%22%20%26%26%20event%20instanceof%20Event%20%26%26%20%22screenX%22%20in%20event%29%20//%20FireGestures%0A%09%09e%20%3D%20event%3B%0A%09else%20if%28this%20%3D%3D%20window%20%26%26%20%22mgGestureState%22%20in%20window%20%26%26%20%22endEvent%22%20in%20mgGestureState%29%20//%20Mouse%20Gestures%20Redox%0A%09%09e%20%3D%20mgGestureState.endEvent%3B%0A%09else%20%7B%0A%09%09let%20anchor%20%3D%20this%20instanceof%20XULElement%20%26%26%20this%0A%09%09%09%7C%7C%20window.gBrowser%20%26%26%20gBrowser.selectedBrowser%0A%09%09%09%7C%7C%20document.documentElement%3B%0A%09%09if%28%22boxObject%22%20in%20anchor%29%20%7B%0A%09%09%09let%20bo%20%3D%20anchor.boxObject%3B%0A%09%09%09e%20%3D%20%7B%0A%09%09%09%09screenX%3A%20bo.screenX%2C%0A%09%09%09%09screenY%3A%20bo.screenY%0A%09%09%09%7D%3B%0A%09%09%09if%28this%20instanceof%20XULElement%29%0A%09%09%09%09e.screenY%20+%3D%20bo.height%3B%0A%09%09%7D%0A%09%7D%0A%09if%28%21e%20%7C%7C%20%21%28%22screenX%22%20in%20e%29%29%0A%09%09throw%20new%20Error%28%22%5BExtensions%20Installer%5D%3A%20Can%27t%20get%20event%20object%22%29%3B%0A%09document.documentElement.appendChild%28mp%29%3B%0A%09mp.addEventListener%28%22popuphidden%22%2C%20function%20destroy%28e%29%20%7B%0A%09%09mp.removeEventListener%28e.type%2C%20destroy%2C%20false%29%3B%0A%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09//mp.destroyMenu%28%29%3B%0A%09%09%09mp.parentNode.removeChild%28mp%29%3B%0A%09%09%7D%2C%200%29%3B%0A%09%7D%2C%20false%29%3B%0A%09mp.openPopupAtScreen%28e.screenX%2C%20e.screenY%29%3B%0A%7D%0A%0Afunction%20notify%28title%2C%20text%2C%20icon%29%20%7B%0A%09Components.classes%5B%22@mozilla.org/alerts-service%3B1%22%5D%0A%09%09.getService%28Components.interfaces.nsIAlertsService%29%0A%09%09.showAlertNotification%28%0A%09%09%09icon%20%7C%7C%20%22chrome%3A//mozapps/skin/extensions/extensionGeneric.png%22%2C%0A%09%09%09%22Extensions%20Installer%3A%20%22%20+%20title%2C%0A%09%09%09text%0A%09%09%29%3B%0A%7D%0Afunction%20error%28title%2C%20text%29%20%7B%0A%09notify%28title%2C%20text%2C%20%22chrome%3A//global/skin/icons/Warning.png%22%29%3B%0A%7D%0Afunction%20expandVariables%28str%29%20%7B%0A%09var%20props%20%3D%20Components.classes%5B%22@mozilla.org/file/directory_service%3B1%22%5D%0A%09%09.getService%28Components.interfaces.nsIProperties%29%3B%0A%09var%20env%20%3D%20Components.classes%5B%22@mozilla.org/process/environment%3B1%22%5D%0A%09%09.getService%28Components.interfaces.nsIEnvironment%29%3B%0A%09return%20str.replace%28/%25%28%5B%5E%25%5D+%29%25/g%2C%20function%28s%2C%20alias%29%20%7B%0A%09%09try%20%7B%0A%09%09%09return%20props.get%28alias%2C%20Components.interfaces.nsIFile%29.path%3B%0A%09%09%7D%0A%09%09catch%28e%29%20%7B%0A%09%09%7D%0A%09%09if%28env.exists%28alias%29%29%0A%09%09%09return%20env.get%28alias%29%3B%0A%09%09return%20s%3B%0A%09%7D%29%3B%0A%7D%0Afunction%20file%28path%29%20%7B%0A%09var%20file%20%3D%20Components.classes%5B%22@mozilla.org/file/local%3B1%22%5D%0A%09%09.createInstance%28Components.interfaces.nsILocalFile%20%7C%7C%20Components.interfaces.nsIFile%29%3B%0A%09file.initWithPath%28path%29%3B%0A%09return%20file%3B%0A%7D%0Afunction%20ProgressIcon%28btn%29%20%7B%0A%09var%20app%20%3D%20Services.appinfo.name%3B%0A%09if%28app%20%3D%3D%20%22SeaMonkey%22%29%0A%09%09this.imgConnecting%20%3D%20this.imgLoading%20%3D%20%22chrome%3A//communicator/skin/icons/loading.gif%22%3B%0A%09else%20if%28app%20%3D%3D%20%22Thunderbird%22%29%20%7B%0A%09%09this.imgConnecting%20%3D%20%22chrome%3A//messenger/skin/icons/connecting.png%22%3B%0A%09%09this.imgLoading%20%3D%20%22chrome%3A//messenger/skin/icons/loading.png%22%3B%0A%09%7D%0A%09else%20%7B%0A%09%09this.imgConnecting%20%3D%20%22chrome%3A//browser/skin/tabbrowser/connecting.png%22%3B%0A%09%09this.imgLoading%20%3D%20%22chrome%3A//browser/skin/tabbrowser/loading.png%22%3B%0A%09%7D%0A%09if%28%21%28btn%20instanceof%20XULElement%29%29%20%7B%0A%09%09this.loading%20%3D%20this.restore%20%3D%20function%28%29%20%7B%7D%3B%0A%09%09return%20this%3B%0A%09%7D%0A%09var%20useAnimation%20%3D%20app%20%3D%3D%20%22Firefox%22%20%26%26%20parseFloat%28Services.appinfo.platformVersion%29%20%3E%3D%2032%3B%0A%09var%20btnIcon%20%3D%20btn.ownerDocument.getAnonymousElementByAttribute%28btn%2C%20%22class%22%2C%20%22toolbarbutton-icon%22%29%3B%0A%09var%20origIcon%20%3D%20btnIcon.src%3B%0A%09btnIcon.src%20%3D%20this.imgConnecting%3B%0A%09if%28useAnimation%29%20%7B%0A%09%09let%20cs%20%3D%20btnIcon.ownerDocument.defaultView.getComputedStyle%28btnIcon%2C%20null%29%3B%0A%09%09let%20s%20%3D%20btnIcon.style%3B%0A%09%09s.margin%20%3D%20%5Bcs.marginTop%2C%20cs.marginRight%2C%20cs.marginBottom%2C%20cs.marginLeft%5D.join%28%22%20%22%29%3B%0A%09%09s.padding%20%3D%20%5Bcs.paddingTop%2C%20cs.paddingRight%2C%20cs.paddingBottom%2C%20cs.paddingLeft%5D.join%28%22%20%22%29%3B%0A%09%09s.width%20%3D%20cs.width%3B%0A%09%09s.height%20%3D%20cs.height%3B%0A%09%09s.boxShadow%20%3D%20%22none%22%3B%0A%09%09s.borderColor%20%3D%20s.background%20%3D%20%22transparent%22%3B%0A%09%09btnIcon.setAttribute%28%22fadein%22%2C%20%22true%22%29%3B%0A%09%09btnIcon.setAttribute%28%22busy%22%2C%20%22true%22%29%3B%0A%09%09btnIcon.classList.add%28%22tab-throbber%22%29%3B%0A%09%09btnIcon._restore%20%3D%20function%28%29%20%7B%0A%09%09%09delete%20btnIcon._restore%3B%0A%09%09%09btnIcon.removeAttribute%28%22busy%22%29%3B%0A%09%09%09btnIcon.removeAttribute%28%22progress%22%29%3B%0A%09%09%09setTimeout%28function%28%29%20%7B%0A%09%09%09%09btnIcon.classList.remove%28%22tab-throbber%22%29%3B%0A%09%09%09%09btnIcon.removeAttribute%28%22style%22%29%3B%0A%09%09%09%09btnIcon.removeAttribute%28%22fadein%22%29%3B%0A%09%09%09%7D%2C%200%29%3B%0A%09%09%7D%3B%0A%09%7D%0A%09this.loading%20%3D%20function%28%29%20%7B%0A%09%09btnIcon.src%20%3D%20this.imgLoading%3B%0A%09%09if%28useAnimation%29%0A%09%09%09btnIcon.setAttribute%28%22progress%22%2C%20%22true%22%29%3B%0A%09%7D%3B%0A%09this.restore%20%3D%20function%28%29%20%7B%0A%09%09btnIcon.src%20%3D%20origIcon%3B%0A%09%09if%28useAnimation%29%0A%09%09%09btnIcon._restore%28%29%3B%0A%09%7D%3B%0A%09return%20this%3B%0A%7D%5D%5D%3E%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E"
>Install</a>
| <a href="https://github.com/Infocatcher/Custom_Buttons/tree/master/Extensions_Installer">Source</a>
| <a href="https://github.com/Infocatcher/Custom_Buttons#usage">Instructions</a>
<script type="text/javascript">
var a = document.getElementsByTagName("a")[0];
a.title = document.title;
if(/%3Cimage%3E%3C%21%5BCDATA%5B(data%3A\S+)%5D%5D%3E%3C\/image%3E/.test(a.href)) {
	var icon = decodeURIComponent(RegExp.$1);

	var img = document.createElement("img");
	img.src = icon;
	img.alt = "";
	img.style.verticalAlign = "middle";
	img.style.marginRight = "4px";
	img.style.border = "none";
	a.insertBefore(img, a.firstChild);

	var link = document.createElement("link");
	link.rel = "shortcut icon";
	link.href = icon;
	document.documentElement.insertBefore(link, document.documentElement.firstChild);
}
</script>
<script type="text/javascript" src="https://infocatcher.github.io/Custom_Buttons/viewCustomButton.js"></script>
<script type="text/javascript">
if("viewCustomButtonCode" in window) setTimeout(function() {
	viewCustomButtonCode(a.href);
}, 0);
</script>
</body>